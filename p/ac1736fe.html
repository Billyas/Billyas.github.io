

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/box.svg">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="Billyme">
  <meta name="author" content="Billyme">
  <meta name="keywords" content="">
  
    <meta name="google-site-verification" content="M1pjYL5H4acOcAhF75kYnj88TUffEUhKN5uQ1z-jHIk" /><meta name="msvalidate.01" content="094ECD52C4255ECD057DE8C73671632D" /><meta name="baidu-site-verification" content="code-CvaeMLX0t0" />
  
  <title>【Caddy2】最新Caddy2配置文件解析 - Billyme的博客</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"billyas.github.io","root":"/","version":"1.8.11","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Billyme</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="【Caddy2】最新Caddy2配置文件解析">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-05-03 11:59" pubdate>
        2022年5月3日 中午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      3.6k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      40
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">【Caddy2】最新Caddy2配置文件解析</h1>
            
            <div class="markdown-body">
              <h1 id="原创声明"><a href="#原创声明" class="headerlink" title="原创声明"></a>原创声明</h1><blockquote>
<p>作者：Billyme (詩)</p>
<p>博客园：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/billyme/">https://www.cnblogs.com/billyme/</a></p>
<p>CSDN ：<a target="_blank" rel="noopener" href="https://blog.csdn.net/horizon08">https://blog.csdn.net/horizon08</a></p>
<p>Gitee：<a target="_blank" rel="noopener" href="https://billyme.gitee.io/blog/">https://billyme.gitee.io/blog/</a></p>
<p>本文为 <strong>Billyme <strong>原创作品，仅发表于以上平台，</strong>不允许转载</strong></p>
</blockquote>
<h1 id="Caddy-介绍"><a href="#Caddy-介绍" class="headerlink" title="Caddy 介绍"></a>Caddy 介绍</h1><blockquote>
<p>Caddy官网：<a target="_blank" rel="noopener" href="https://caddyserver.com/">CaddyServer</a></p>
<p>THE ULTIMATE SERVER<br>Caddy 2 is a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go</p>
</blockquote>
<h1 id="Caddy2的升级指南"><a href="#Caddy2的升级指南" class="headerlink" title="Caddy2的升级指南"></a>Caddy2的升级指南</h1><h3 id="升级指南🔗"><a href="#升级指南🔗" class="headerlink" title="升级指南🔗"></a>升级指南<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#upgrade-guide">🔗</a></h3><p>Caddy 2 是一个全新的代码库，从头开始编写，以改进 Caddy 1。Caddy 2 不向后兼容 Caddy 1。但不用担心，对于大多数基本设置，并没有太大的不同。本指南将帮助您尽可能轻松地过渡。</p>
<p>本指南不会深入研究可用的新功能——它们真的很酷，顺便说一下，你应该<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/getting-started">学习它们</a>——这里的目标是让你快速启动并运行 Caddy 2。</p>
<h3 id="菜单🔗"><a href="#菜单🔗" class="headerlink" title="菜单🔗"></a>菜单<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#menu">🔗</a></h3><ul>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#high-order-bits">高位</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#steps">脚步</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#https-and-ports">HTTPS 和端口</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#command-line">命令行</a></li>
<li>球童档案<ul>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#primary-changes">主要变化</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#basicauth">基本认证</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#browse">浏览</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#errors">错误</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#ext">分机</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#fastcgi">快速cgi</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#gzip">压缩包</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#header">标题</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#log">日志</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#proxy">代理</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#redir">重新目录</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#rewrite">改写</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#root">根</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#status">状态</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#templates">模板</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#tls">tls</a></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#service-files">服务文件</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#plugins">插件</a></li>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#getting-help">获得帮助</a></li>
</ul>
<h2 id="高位🔗"><a href="#高位🔗" class="headerlink" title="高位🔗"></a>高位<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#high-order-bits">🔗</a></h2><ul>
<li>“Caddy 2”仍然只是被称为<code>caddy</code>。我们可能会使用“Caddy 2”来阐明哪个版本可以使过渡不那么混乱。</li>
<li>大多数用户只需要替换他们的<code>caddy</code>二进制文件和更新的<code>Caddyfile</code>配置（在测试它是否有效之后）。</li>
<li>最好不要从 Caddy 1 继承任何假设进入 Caddy 2。</li>
<li>您可能无法在 v2 中完美复制您的利基 v1 配置。通常，这是有充分理由的。</li>
<li>命令行不再用于服务器配置。</li>
<li>配置不再需要环境变量。</li>
<li>为 Caddy 2 提供配置的主要方法是通过其<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/api">API</a>，但也可以使用<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/command-line"><code>caddy</code>命令。</a></li>
<li>您应该知道 Caddy 2 的原生配置语言是<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/json/">JSON</a>，而 Caddyfile 只是另一个为您转换为 JSON 的<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/config-adapters">配置适配器</a>。极端自定义/高级用例可能需要 JSON，因为并非所有可能的配置都可以由 Caddyfile 表示。</li>
<li>Caddyfile 基本相同，但功能更强大；指令已更改。</li>
</ul>
<h2 id="脚步🔗"><a href="#脚步🔗" class="headerlink" title="脚步🔗"></a>脚步<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#steps">🔗</a></h2><ol>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/getting-started">通过我们的入门</a>教程熟悉 Caddy 2 。</li>
<li>如果您还没有，请执行第 1 步。说真的——我们不能强调至少知道如何使用 Caddy 2 的重要性。（它更有趣！）</li>
<li>使用以下指南转换您的<code>caddy</code>命令。</li>
<li>使用以下指南转换您的 Caddyfile。</li>
<li>在本地或暂存中测试您的新配置。</li>
<li>测试，测试，再测试</li>
<li>部署并玩得开心！</li>
</ol>
<h2 id="HTTPS-和端口🔗"><a href="#HTTPS-和端口🔗" class="headerlink" title="HTTPS 和端口🔗"></a>HTTPS 和端口<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#https-and-ports">🔗</a></h2><p>Caddy 的默认端口不再是<code>:2015</code>. Caddy 2 的默认端口是<code>:443</code>，或者，如果不知道主机名/IP，则为 port <code>:80</code>。您始终可以在配置中自定义端口。</p>
<p><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/automatic-https#overview">如果主机名或 IP 已知</a>， Caddy 2 的默认协议<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/automatic-https#overview"><em>始终</em></a>是 HTTPS 。这与 Caddy 1 不同，在 Caddy 1 中，默认情况下只有公开域名使用 HTTPS。现在，<em>每个</em>站点都使用 HTTPS（除非您通过明确指定端口<code>:80</code>或禁用它<code>http://</code>）。</p>
<p>IP 地址和 localhost 域将从<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/automatic-https#local-https">本地受信任的嵌入式 CA</a>颁发证书。所有其他域将使用 ZeroSSL 或 Let’s Encrypt。（这都是可配置的。）</p>
<p>证书和 ACME 资源的存储结构发生了变化。Caddy 2 可能会为您的站点获得新证书；但是如果您有很多证书，如果它不适合您，您可以手动迁移它们。有关详细信息，请参阅问题<a target="_blank" rel="noopener" href="https://github.com/caddyserver/caddy/issues/2955">#2955</a>和<a target="_blank" rel="noopener" href="https://github.com/caddyserver/caddy/issues/3124">#3124</a>。</p>
<h2 id="命令行🔗"><a href="#命令行🔗" class="headerlink" title="命令行🔗"></a>命令行<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#command-line">🔗</a></h2><p><code>caddy</code>命令现在是<code>caddy run</code>.</p>
<p>所有命令行标志都是不同的。删除它们；所有服务器配置现在都存在于实际配置文档中（通常是 Caddyfile 或 JSON）。<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/json/">您可能会在JSON 结构</a>或<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/options">Caddyfile 全局选项</a>中找到您需要的内容，以替换 v1.1 中的大多数命令行标志。</p>
<p>像这样的命令<code>caddy -conf ../Caddyfile</code>会变成<code>caddy run --config ../Caddyfile</code>.</p>
<p>和以前一样，如果您的 Caddyfile 在当前文件夹中，Caddy 会自动找到并使用它；在这种情况下，您不需要使用该<code>--config</code>标志。</p>
<p>信号基本相同，只是不再支持 USR1 和 USR2。请改用<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/command-line#caddy-reload"><code>caddy reload</code></a>命令或<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/api">API</a>来加载新配置。</p>
<p>在没有任何配置的情况下运行<code>caddy</code>用于运行简单的文件服务器。Caddy 2 中的等价物是<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/command-line#caddy-file-server"><code>caddy file-server</code></a>.</p>
<p>环境变量不再相关，除了<code>HOME</code>（并且，可选地，<code>XDG_*</code>您设置的任何变量）。<code>CADDYPATH</code>被<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/conventions#file-locations">操作系统约定所</a>取代。</p>
<h2 id="球童档案🔗"><a href="#球童档案🔗" class="headerlink" title="球童档案🔗"></a>球童档案<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#caddyfile">🔗</a></h2><p><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/concepts">v2 Caddyfile</a>与您已经熟悉的非常相似。您需要做的主要事情是更改指令。</p>
<p>⚠️<strong>请务必阅读新指令！</strong>特别是如果您的配置更高级，则需要考虑许多细微差别。这些技巧可以让你快速切换，但请阅读每个指令的完整文档，以便了解升级的含义。当然，在将它们投入生产之前，请务必彻底测试您的配置。</p>
<h3 id="主要变化🔗"><a href="#主要变化🔗" class="headerlink" title="主要变化🔗"></a>主要变化<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#primary-changes">🔗</a></h3><ul>
<li>如果你提供静态文件，你需要添加一个<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/file_server"><code>file_server</code>指令</a>，因为 Caddy 2 默认不假设这个。出于安全原因，默认情况下 Caddy 2 也不嗅探 MIME。如果缺少 Content-Type，您可能需要使用<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/header">header</a>指令自己设置标头。</li>
<li>在 v1 中，您只能按请求路径过滤（或“匹配”）指令。在 v2 中，<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/matchers">请求匹配</a>功能更加强大。任何向 HTTP 处理程序链添加中间件或以任何方式操纵 HTTP 请求/响应的 v2 指令都利用了这个新的匹配功能。<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/matchers">阅读有关 v2 请求匹配器的更多信息。</a>您需要了解它们才能理解 v2 Caddyfile。</li>
<li>尽管许多<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/conventions#placeholders">占位符</a>是相同的，但许多已更改，现在有<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/modules/http#docs">许多新</a>占位符，包括<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/concepts#placeholders">Caddyfile 的简写</a>。</li>
<li>Caddy 2 的日志都是结构化的，默认格式是 JSON。所有日志级别都可以简单地转到要处理的同一日志（但如果需要，您可以自定义）。</li>
<li>在 Caddy 1 中通过路径前缀匹配请求的情况下，现在默认情况下 Caddy 2 中的路径匹配是精确的。如果要匹配类似 的前缀<code>/foo/</code>，则需要<code>/foo/*</code>在 Caddy 2 中匹配。</li>
</ul>
<p>我们将在这里列出一些最常见的 v1 指令，并描述如何转换它们以在 v2 Caddyfile 中使用。</p>
<p>⚠️<strong>仅仅因为此页面缺少 v1 指令并不意味着 v2 不能做到！</strong>一些 v1 指令不需要，翻译不好，或者在 v2 中以其他方式实现。对于一些高级定制，您可能需要下拉到 JSON 以获得您想要的。浏览<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile">我们的文档</a>以找到您需要的内容！</p>
<h3 id="基本认证🔗"><a href="#基本认证🔗" class="headerlink" title="基本认证🔗"></a>基本认证<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#basicauth">🔗</a></h3><p>HTTP 基本身份验证仍使用该<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/basicauth"><code>basicauth</code></a>指令进行配置。但是，Caddy 2 配置不接受明文密码。您必须对它们进行哈希处理，这<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/command-line#caddy-hash-password"><code>caddy hash-password</code></a>可以提供帮助。</p>
<ul>
<li><strong>v1：</strong></li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">basicauth <span class="hljs-regexp">/secret/</span> Bob hiccup<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>v2：</strong></li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">basicauth <span class="hljs-regexp">/secret/</span>* &#123;<br>	Bob JDJhJDEwJEVCNmdaNEg2Ti5iejRMYkF3MFZhZ3VtV3E1SzBWZEZ5Q3VWc0tzOEJwZE9TaFlZdEVkZDhX<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="浏览🔗"><a href="#浏览🔗" class="headerlink" title="浏览🔗"></a>浏览<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#browse">🔗</a></h3><p>现在通过<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/file_server"><code>file_server</code></a>指令启用文件浏览。</p>
<ul>
<li><strong>v1：</strong></li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">browse <span class="hljs-regexp">/subfolder/</span><br></code></pre></td></tr></table></figure>

<ul>
<li><strong>v2：</strong></li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">file_server <span class="hljs-regexp">/subfolder/</span>* browse<br></code></pre></td></tr></table></figure>

<h3 id="错误🔗"><a href="#错误🔗" class="headerlink" title="错误🔗"></a>错误<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#errors">🔗</a></h3><p>自定义错误页面可以使用<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/handle_errors"><code>handle_errors</code></a>.</p>
<ul>
<li><strong>v1:</strong> :</li>
</ul>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dns">errors &#123;<br>	<span class="hljs-number">404 404</span>.html<br>	<span class="hljs-number">500 500</span>.html<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>v2:</strong> :</li>
</ul>
<figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs tcl">handle_errors &#123;<br>	rewrite * /&#123;<span class="hljs-keyword">http</span>.<span class="hljs-keyword">error</span>.status_code&#125;.html<br>	file_server<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="分机🔗"><a href="#分机🔗" class="headerlink" title="分机🔗"></a>分机<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#ext">🔗</a></h3><p>隐含的文件扩展名可以用<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/try_files"><code>try_files</code></a>.</p>
<ul>
<li><strong>v1：</strong> <code>ext .html</code></li>
<li><strong>v2：</strong> <code>try_files &#123;path&#125;.html &#123;path&#125;</code></li>
</ul>
<h3 id="快速cgi🔗"><a href="#快速cgi🔗" class="headerlink" title="快速cgi🔗"></a>快速cgi<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#fastcgi">🔗</a></h3><p>假设您正在使用 PHP，则 v2 等效项是<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/php_fastcgi"><code>php_fastcgi</code></a>.</p>
<ul>
<li><strong>v1：</strong></li>
</ul>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">fastcgi</span> / localhost:<span class="hljs-number">9005</span> php<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>v2：</strong></li>
</ul>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">php_fastcgi</span> localhost:<span class="hljs-number">9005</span><br></code></pre></td></tr></table></figure>

<p>请注意，<code>fastcgi</code>v1 中的指令在后台做了很多工作，包括尝试磁盘上的文件、重写请求，甚至重定向。v2<code>php_fastcgi</code>指令也为您做这些事情，但文档提供了<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/php_fastcgi#expanded-form">扩展形式</a>，如果您的要求不同，您可以对其进行修改。</p>
<p><code>php</code>v2中不需要预设，因为该<code>php_fastcgi</code>指令默认采用 PHP。诸如此类的行<code>php_fastcgi 127.0.0.1:9000 php</code>会导致反向代理认为有第二个后端称为<code>php</code>，从而导致连接错误。</p>
<p>v2 中的子指令不同——您可能不需要任何 PHP 指令。</p>
<h3 id="压缩包🔗"><a href="#压缩包🔗" class="headerlink" title="压缩包🔗"></a>压缩包<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#gzip">🔗</a></h3><p>现在，一个指令<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/encode"><code>encode</code></a>用于所有响应编码，包括多种压缩格式。</p>
<ul>
<li><strong>v1：</strong></li>
</ul>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">gzip</span><br></code></pre></td></tr></table></figure>

<ul>
<li><strong>v2：</strong></li>
</ul>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">encode gzip</span><br></code></pre></td></tr></table></figure>

<p>有趣的事实：Caddy 2 也支持<code>zstd</code>（但还没有浏览器支持）。</p>
<h3 id="标题🔗"><a href="#标题🔗" class="headerlink" title="标题🔗"></a>标题<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#header">🔗</a></h3><p><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/header">大部分没有改变</a>，但现在更强大，因为它可以在 v2 中进行子字符串替换。</p>
<ul>
<li><strong>v1：</strong></li>
</ul>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">header</span> / <span class="hljs-keyword">Strict</span>-Transport-<span class="hljs-keyword">Security</span> max-age=<span class="hljs-number">31536000</span>;<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>v2：</strong></li>
</ul>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">header</span> <span class="hljs-keyword">Strict</span>-Transport-<span class="hljs-keyword">Security</span> max-age=<span class="hljs-number">31536000</span>;<br></code></pre></td></tr></table></figure>

<h3 id="日志🔗"><a href="#日志🔗" class="headerlink" title="日志🔗"></a>日志<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#log">🔗</a></h3><p>启用访问记录；该<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/log"><code>log</code></a>指令仍然可以在 v2 中使用，但默认情况下，所有日志都是结构化的，编码为 JSON。</p>
<p>启用访问日志的推荐方法很简单：</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-built_in">log</span><br></code></pre></td></tr></table></figure>

<p>它将结构化日志发送到标准错误。（您也可以发送到文件或网络套接字；请参阅<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/log"><code>log</code></a>指令文档。）</p>
<p>默认情况下，日志将采用<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/logging">结构化</a>JSON 格式。如果由于遗留原因您仍然需要通用日志格式 (CLF) 的日志，您可以使用该<a target="_blank" rel="noopener" href="https://github.com/caddyserver/transform-encoder"><code>transform-encoder</code></a>插件。</p>
<h3 id="代理🔗"><a href="#代理🔗" class="headerlink" title="代理🔗"></a>代理<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#proxy">🔗</a></h3><p>v2 等效项是<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/reverse_proxy"><code>reverse_proxy</code></a>.</p>
<p>显着的子指令变化分别为<code>header_upstream</code>和；和负载平衡相关的子指令以 . 为前缀。<code>header_downstream``header_up``header_down``lb_</code></p>
<p>另一个显着的区别是 v2 代理默认通过所有传入的标头（包括<code>Host</code>标头）并设置<code>X-Forwarded-For</code>标头。换句话说，v1 的“透明”模式基本上是 v2 中的默认模式（但如果您需要 X-Real-IP 等其他标头，则必须自己设置）。您仍然可以<code>Host</code>使用<code>header_up</code>子指令覆盖/自定义标头。</p>
<p>Websocket 代理在 v2 中“正常工作”；无需像 v1 那样“启用”websocket。</p>
<p>由于改进的匹配器支持，v2 中不再需要<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#rewrite">重写黑客</a>，因此<code>without</code>子指令已被删除。</p>
<ul>
<li><strong>v1：</strong></li>
</ul>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">proxy</span> / localhost:<span class="hljs-number">9005</span><br></code></pre></td></tr></table></figure>

<ul>
<li><strong>v2：</strong></li>
</ul>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">reverse_proxy</span> localhost:<span class="hljs-number">9005</span><br></code></pre></td></tr></table></figure>

<h3 id="重新目录🔗"><a href="#重新目录🔗" class="headerlink" title="重新目录🔗"></a>重新目录<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#redir">🔗</a></h3><p><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/redir">不变</a>，除了一些关于可选状态码参数的细节。大多数配置不需要进行任何更改。</p>
<ul>
<li><strong>v1：</strong> <code>redir https://example.com&#123;uri&#125;</code></li>
<li><strong>v2：</strong> <code>redir https://example.com&#123;uri&#125;</code></li>
</ul>
<h3 id="改写🔗"><a href="#改写🔗" class="headerlink" title="改写🔗"></a>改写<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#rewrite">🔗</a></h3><p>请求重写（“内部重定向”）的语义略有改变。如果您在 v1 中使用所谓的“rewrite hack”作为匹配请求而不是简单路径前缀的方式，那么在 v2 中这是完全没有必要的。</p>
<p>新<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/rewrite">指令非常简单但非常强大，因为它</a><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/rewrite">的<code>rewrite</code></a>大部分复杂性都由v2 中的<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/matchers">匹配器处理：</a></p>
<ul>
<li><strong>v1：</strong></li>
</ul>
<figure class="highlight puppet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs puppet"><span class="hljs-keyword">rewrite</span> &#123;<br>	<span class="hljs-keyword">if</span> &#123;&gt;User-Agent&#125; <span class="hljs-keyword">has</span> <span class="hljs-keyword">mobile</span><br>	<span class="hljs-keyword">to</span> /mobile&#123;uri&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>v2：</strong></li>
</ul>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-keyword">@mobile</span> &#123;<br>	<span class="hljs-selector-tag">header</span> User-Agent *mobile*<br>&#125;<br>rewrite <span class="hljs-keyword">@mobile</span> /mobile&#123;uri&#125;<br></code></pre></td></tr></table></figure>

<p>请注意我们如何简单地使用 Caddy 2 的常用<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/matchers">匹配器令牌</a>；它不再是该指令的特例。</p>
<p>首先删除所有重写黑客；将它们变成<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/concepts#named-matchers">命名匹配器</a>。评估每个 v1<code>rewrite</code>以查看 v2 中是否真的需要它。提示：<code>rewrite</code>用于添加路径前缀然后删除相同前缀<code>proxy</code>的v1 Caddyfile<code>without</code>是一种重写技巧，可以被消除。</p>
<p>您可能会发现新的<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/route"><code>route</code></a>和<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/handle"><code>handle</code></a>指令对于更好地控制高级路由逻辑很有用。</p>
<h3 id="根🔗"><a href="#根🔗" class="headerlink" title="根🔗"></a>根<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#root">🔗</a></h3><p><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/root">未更改</a>，但如果您的根路径以 开头<code>/</code>，则需要添加<code>*</code>匹配器标记以将其与<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/concepts#path-matchers">路径匹配器</a>区分开来。</p>
<ul>
<li><strong>v1：</strong> <code>root /var/www</code></li>
<li><strong>v2：</strong> <code>root * /var/www</code></li>
</ul>
<p>因为它接受 v2 中的匹配器，这意味着您还可以根据请求更改站点根目录。</p>
<p>如果提供静态文件，请记住添加<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/file_server"><code>file_server</code>指令</a>，因为默认情况下 Caddy 2 不假设这一点，而在 v1 中始终启用它。</p>
<h3 id="状态🔗"><a href="#状态🔗" class="headerlink" title="状态🔗"></a>状态<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#status">🔗</a></h3><p>v2 等效的是<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/respond"><code>respond</code></a>，它也可以写一个响应体。</p>
<ul>
<li><strong>v1：</strong></li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">status <span class="hljs-number">404</span> <span class="hljs-regexp">/secrets/</span><br></code></pre></td></tr></table></figure>

<ul>
<li><strong>v2：</strong></li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">respond <span class="hljs-regexp">/secrets/</span>* <span class="hljs-number">404</span><br></code></pre></td></tr></table></figure>

<h3 id="模板🔗"><a href="#模板🔗" class="headerlink" title="模板🔗"></a>模板<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#templates">🔗</a></h3><p>指令的整体语法<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/templates"><code>templates</code></a>没有改变，但实际的模板动作/功能是不同的并且有很大的改进。例如，模板能够包含文件、渲染 markdown、制作内部子请求、解析前端内容等等！</p>
<p><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/modules/http.handlers.templates">有关新功能的详细信息，请参阅文档</a>。</p>
<ul>
<li><strong>v1：</strong> <code>templates</code></li>
<li><strong>v2：</strong> <code>templates</code></li>
</ul>
<h3 id="tls🔗"><a href="#tls🔗" class="headerlink" title="tls🔗"></a>tls<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#tls">🔗</a></h3><p>该<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/caddyfile/directives/tls"><code>tls</code></a>指令的基本原理没有改变，例如指定您自己的证书和密钥：</p>
<ul>
<li><strong>v1：</strong> <code>tls cert.pem key.pem</code></li>
<li><strong>v2：</strong> <code>tls cert.pem key.pem</code></li>
</ul>
<p>但是 Caddy 的<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/automatic-https">自动 HTTPS 逻辑</a> <em>已经</em>改变，所以要注意这一点！</p>
<p>密码套件名称也发生了变化。</p>
<p>Caddy 2 中的一个常见配置是使用<code>tls internal</code>它为非开发主机名<code>localhost</code>或 IP 地址提供本地受信任的证书。</p>
<p>大多数网站根本不需要这个指令。</p>
<h2 id="服务文件🔗"><a href="#服务文件🔗" class="headerlink" title="服务文件🔗"></a>服务文件<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#service-files">🔗</a></h2><p>我们建议使用<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/running#linux-service">我们的官方 systemd 服务文件</a>之一进行 Caddy 部署。</p>
<p>如果您需要自定义服务文件，请以我们的为基础。出于充分的理由，他们已经仔细调整过！如果需要，请务必自定义您的。</p>
<h2 id="插件🔗"><a href="#插件🔗" class="headerlink" title="插件🔗"></a>插件<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#plugins">🔗</a></h2><p>为 v1 编写的插件不会自动与 v2 兼容。v2 甚至不需要许多 v1 插件。另一方面，v2 比 v1 更容易扩展和灵活！</p>
<p>如果您想为 Caddy 2 编写插件，请<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/extending-caddy">学习如何编写 Caddy 模块</a>。</p>
<h3 id="使用插件构建-Caddy-2🔗"><a href="#使用插件构建-Caddy-2🔗" class="headerlink" title="使用插件构建 Caddy 2🔗"></a>使用插件构建 Caddy 2<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#building-caddy-2-with-plugins">🔗</a></h3><p>Caddy 2 可以在<a target="_blank" rel="noopener" href="https://caddyserver.com/download">交互式下载页面</a>通过插件下载。或者，您可以使用<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/build">自己构建 Caddy</a><code>xcaddy</code>并选择要包含的插件。<code>xcaddy</code>自动执行 Caddy 的<a target="_blank" rel="noopener" href="https://github.com/caddyserver/caddy/blob/master/cmd/caddy/main.go">main.go</a>文件中的指令。</p>
<h2 id="获得帮助🔗"><a href="#获得帮助🔗" class="headerlink" title="获得帮助🔗"></a>获得帮助<a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade#getting-help">🔗</a></h2><p>如果您难以让 Caddy 正常工作，请先浏览我们的网站以获取文档。花时间尝试新事物并了解正在发生的事情 - v2 在很多方面与 v1 非常不同（但也非常熟悉）！</p>
<p>如果您仍然需要帮助，请加入<a target="_blank" rel="noopener" href="https://caddy.community/">我们的社区</a>！您可能会发现帮助他人也是帮助自己的最佳方式。</p>
<h1 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h1><ol>
<li>部署静态网页</li>
</ol>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs nginx">http://yousite.<span class="hljs-section">com</span> &#123;<br>	<span class="hljs-attribute">encode</span> gzip <span class="hljs-comment"># gzip压缩</span><br>	root * /var/web/wwwroot <span class="hljs-comment"># web根目录</span><br>	file_server browse  <span class="hljs-comment"># 启动静态资源</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>​    注意，如果配置根目录下有index.html文件，则会自动部署为静态网页，如果没有则为由Caddy提供的文件共享的浏览网页如下。</p>
<ol start="2">
<li>部署File_server</li>
</ol>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nginx">yousite.<span class="hljs-section">com</span> &#123;<br>   	<span class="hljs-attribute">root</span> * /var/share <span class="hljs-comment">#根目录</span><br>   	file_server browse <span class="hljs-comment">#启动web文件服务</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="3">
<li>反向代理</li>
</ol>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nginx">yousite.<span class="hljs-section">com</span> &#123;<br>     	<span class="hljs-attribute">reverse_proxy</span> localhost:<span class="hljs-number">8082</span> <span class="hljs-comment">#反向代理</span><br>&#125;<br>    <br></code></pre></td></tr></table></figure>

<ol start="4">
<li><p>部署</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">caddy</span> adapt  <span class="hljs-comment">## 加载配置文件</span><br><br>caddy fmt	 <span class="hljs-comment">## 格式化配置</span><br><br>caddy start  <span class="hljs-comment">## 启动服务</span><br></code></pre></td></tr></table></figure>

<p>注意，如果为重新部署，请将最后一句start换为 <code>caddy reload</code></p>
</li>
</ol>
<h2 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h2><ol>
<li><a target="_blank" rel="noopener" href="https://caddyserver.com/docs/v2-upgrade">Caddyserver Document</a></li>
</ol>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/p/2a56fdad.html">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">自建GitHub加速，优化图床质量</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/p/3471e027.html">
                        <span class="hidden-mobile">集美大学校园网绑定/认证报错异常及解决方案</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"98T6Seo86MgLR2enaa4jzkqM-9Nh9j0Va","appKey":"m6gb3P43WeGCEhKwI1V5lNkb","placeholder":"说点啥","path":"window.location.pathname","avatar":"retro","meta":["nick","mail","link"],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"https://98t6seo8.lc-cn-e1-shared.com","emojiCDN":null,"emojiMaps":null,"enableQQ":false,"requiredFields":[]},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://www.cnblogs.com/billyme/" target="_blank" rel="nofollow noopener"><span>Billyme</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>



  <script  src="/js/local-search.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
